language: ruby
rvm:
  - 1.9.3

env:
  global:
    - APP_NAME=qhodeheroku2
    - CI_REPORTS=shippable/testresults COVERAGE_REPORTS=shippable/codecoverage
   # - secure: eIQjJv+w/zrCOZCypuy3HdBRqHxmvzvlYk40UtXN2eq4KAqcZxZr7eXiRD14oz2qGzQIIqkU9v41Be0lqQQ/PNCzfI/3GRomVmMBayZbOv0ovEuK2lDHlVc4BtM8+44nwX9D19MR0ohjfOWkAD6AkftiP1qfxnmFBj+Zs/FNqn0rDAPT+GEc/yXv4/5kbRf7BDAq5JJAJLXWaSxAq9wElRTpgkndeqNGryC9Lhaf/R5ndV5Qow2VeLslP1FRijQGi9uxR1/XvEdnYowqucHWbGMoRvpws3jzPaey6qt9CPqgrbOqWY7UXuL99I0hntnbnYrCjlSHxCysMNVGp8JrFQ==
    - secure: MRuHkLbL9HPkJPU5lzkKM1+NOq1S5RrhxEyhJkk60xxYiF7DMzydiBN8oFBjWrSmyGeGRuEC22a0I5ItobdWVszfcJCaXHwtfKzfGOUdKuyCnDgvojXhv/jrBvULyLK6zsLw3b8NMxdnwNsHqSPm19qW/EIGEl9Zv/637Igos69z9aT7+xrEG013+6HtKYb8RHm+iPSNsFoBi/RSAHYuM1eLTZWG2WAkjgzZaYmrHCgNwVmk+HOGR+TOWN7Iu5lrjyvC1XDCQrOvo1hZI30cd9OqJ5aadFm3exQpNhI4I7AgOnCbK3NoWNc/GAnqKXCvsaIQ80Jd/uLIOVyMjD6Xmg==
build:
   ci:
     - ruby -v
     - which heroku || wget -qO- https://toolbelt.heroku.com/install-ubuntu.sh | sh
     - mkdir -p shippable/testresults
     - mkdir -p shippable/codecoverage
    # - psql -c 'create database "sample-rubyonrails-postgres-heroku_test";' -U postgres
     - test -f ~/.ssh/id_rsa.heroku || ssh-keygen -y -f /tmp/ssh/00_sub > ~/.ssh/id_rsa.heroku && heroku keys:add ~/.ssh/id_rsa.heroku
     #- test -f ~/.ssh/id_rsa.heroku || ssh-keygen -y -f ~/.ssh/id_rsa > ~/.ssh/id_rsa.heroku && heroku keys:add ~/.ssh/id_rsa.heroku
     - git remote -v | grep ^heroku || heroku git:remote --ssh-git --app $APP_NAME
     - git push -f heroku $BRANCH:master
     - heroku run rake db:migrate
    # - git push -f git@heroku.com:$APP_NAME.git master
   #  https://git.heroku.com/conan.git
  
# before_install:
#   - which heroku || wget -qO- https://toolbelt.heroku.com/install-ubuntu.sh | sh

# before_script: 
#   - mkdir -p shippable/testresults
#   - mkdir -p shippable/codecoverage
#   - psql -c 'create database "sample-rubyonrails-postgres-heroku_test";' -U postgres

# after_success:
#   - test -f ~/.ssh/id_rsa.heroku || ssh-keygen -y -f ~/.ssh/id_rsa > ~/.ssh/id_rsa.heroku && heroku keys:add ~/.ssh/id_rsa.heroku
#   - git remote -v | grep ^heroku || heroku git:remote --ssh-git --app $APP_NAME
#   - git push -f heroku $BRANCH:master
#   - heroku run rake db:migrate
# on_success:
#   - git push -f git@heroku.com:$APP_NAME.git master
# before_install:
#   - which heroku || wget -qO- https://toolbelt.heroku.com/install-ubuntu.sh | sh

# before_script: 
#   - mkdir -p shippable/testresults
#   - mkdir -p shippable/codecoverage
#   - psql -c 'create database "sample-rubyonrails-postgres-heroku_test";' -U postgres

# after_success:
#   - test -f ~/.ssh/id_rsa.heroku || ssh-keygen -y -f ~/.ssh/id_rsa > ~/.ssh/id_rsa.heroku && heroku keys:add ~/.ssh/id_rsa.heroku
#   - git remote -v | grep ^heroku || heroku git:remote --ssh-git --app $APP_NAME
#   - git push -f heroku $BRANCH:master
#   - heroku run rake db:migrate
